<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="论软件可靠性设计技术的应用"><meta name="keywords" content=""><meta name="author" content="keon,undefined"><meta name="copyright" content="keon"><title>论软件可靠性设计技术的应用 | keon随便写写</title><link rel="shortcut icon" href="/my-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.5.6"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css?version=1.5.6"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><link rel="dns-prefetch" href="https://hm.baidu.com"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?ae0586f75159e5097cb79871b2fdb3a1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();</script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
} </script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">keon</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">9</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">3</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">2</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://raw.githubusercontent.com/awdclijn/awdclijn.github.io/master/img/kim-holtermand-reflections.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">keon随便写写</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div><div id="post-info"><div id="post-title">论软件可靠性设计技术的应用</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-11-09</time><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">2,198</span><span class="post-meta__separator">|</span><span>阅读时长: 6 分钟</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>【摘要】<br>2017年4月份，某股份制银行启动了新征信管理平台的系统项目，本人所在的大数据支持处室负责了数据存储、查询及数据标准化等功能的建设，本人作为项目经办负责技术方案的管理和设计。征信管理平台是我行风险控制的重要部分，维护有个人、对公征信、互联网小贷、电信运营商等数据。征信管理平台承载了大量业务在风险控制环节对数据的诉求，如新发卡、贷前、贷中等关键业务流程，因此行内提出了较高的可靠性要求。为达到该系统的可靠性要求，本人带领合作公司团队对系统的运行环境和特点等进行分析，根据分析出的结果制定了提高系统可靠性的措施：一是采用了健康检查的思路，出现故障后可自动拉起应用并告警；二是降低主流程复杂度，将主流程外的处理通过队列异步处理。三是容错机制的设计，建议业务采购多家供应商的接口，形成主备模式。至从2017年6月开放第一批接口，截至2017年年末已接入数据源40余个，系统投产后大量的外部征信数据能在有效期内得到复用，节约了大量的费用，同时系统的高性能、高可用性的特点也得到业务部门的一致好评。</p>
<p>【正文】<br>随着银行业的快速发展，各业务部门对风险管理的要求越来越高，需要更加丰富的征信数据帮忙完成业务流程，同时旧征信平台中使用的传统应用和数据库架构已无法满足业务发展的需求，因此行内提出了建设新征信管理平台的诉求。大量的征信外部数据也是对大数据平台数据源的一个完善，因此我所在的处室承担了相关数据存储、查询及数据标准化等功能的建设（本文中仅对实时应用部分讨论，离线部分不具体展开），本人负责技术方案的管理和设计。总体上系统采用了微服务的架构：1、查询服务按业务领域进行划分，有征信服务、运营商服务、个人属性服务等负责具体数据的查询、主备供应商的切换及数据的标准化，并且将查询后的数据及相关的日志信息防止队列中间件中；2、数据回写服务负责从队列将数据入库，并根据规则生成有效期等字段，以便数据复用。3、服务治理的相关组件，注册中心负责管理服务的元信息；配置中心负责管理各服务的配置文件；网关负责交易请求的路由。4、数据存储上采用了分布式的中间件Elasticsearch，过程中直接存取非结构化数据，减少关联查询。</p>
<p>征信管理平台涉及的关键业务流程多，访问量大，因此行内提出了较高的可靠性要求。要提高系统的可靠性指标，团队首先进行可靠性影响分析，主要采用了故障树分析方法。故障树分析方法是一种自顶向下的软件可靠性分析方法，从软件系统不希望发生的事件向下逐步追查导致事件发生的原因，直至基本事件，从而确定软件故障的原因。经过分析，我们找出了以下导致故障发生的基本事件：</p>
<p>一、运行硬件，应用所依赖的运行硬件并不是完全可靠的，随着时间推移，硬件会发生老化从而产生故障。</p>
<p>二、模块规模及内部结构的复杂度，模块的规模越大、复杂度越高，其开发测试的难度也越大，我们需要尽量降低主流程的复杂度，让整个架构实现更加可控。</p>
<p>三、外部依赖，征信数据的来源是第三方的数据服务提供商，每个服务提供商的服务质量参差不齐。虽然有商务合同进行约束，但实际情况中经常会出现无法提供服务的情况。</p>
<p>常用的软件可靠性技术有容错设计、检错设计、降低复杂度设计等。容错设计可以通过冗余或者备份的方式代替故障服务，从而维护软件系统的正常运行；检错设计是当软件系统出现故障时能及时发现并告警提示维护人员处理的能力；降低复杂度设计的思想是保证实现软件功能的基础上，简化软件结构，优化软件数据流向，降低软件复杂度，从而提高软件可靠性。根据以上的分析，结合行内的技术特点，我们制定了如下的可靠性设计方案。</p>
<p>一、在整体的部署架构中采用多活的方式进行部署，建立健康检查的机制，并且与行内集中告警平台对接。</p>
<p>应用服务以多实例的方式部署在行内已有docker云平台中，应用暴露接口供云平台进行健康检查，若长时间判断为不健康时，云平台可自动拉起新的服务实例，关闭故障实例，并进行统一告警。同时在应用逻辑中提供了重试的请求机制，通过网关服务进行流量分发时，若无法分发至目标服务，则会重试分发逻辑。如仍无法分发，则会从注册中心中挑选另一个可用实例进行分发路由，保障服务的连续。</p>
<p>二、降低业务主流程程序中的复杂度，将回写数据、日志信息等放入到kafka消息队列中间件中，后续由其他应用进行数据消费处理。</p>
<p>征信数据在业务定义的有效期内可反复使用，节约外发请求第三方的费用，因此需要将查询后的数据结果进行存储。在该方案设计中，查询后的数据会直接放入到消息队列中，由数据回写服务根据业务配置的有效期规则，计算数据有效期后进行入库。该设计将查询和写入操作解耦，模块之间消除依赖，查询服务外的应用出现故障，最坏结果只是会造成服务降级，无法查得存量数据，并不会影响正常的业务的开展。由于各服务的轻量级设计思路，后续的维护复杂度降低，便于评估变更影响，提高整个系统的可靠性。</p>
<p>三、采用了冗余设计的思路，向业务建议采购多个提供相同服务的数据提供商形成服务的主备架构。</p>
<p>第三方的服务质量及数据质量都无法控制，从设计上规划了两种策略进行冗余，1）主备供应商，即查询时根据业务配置的主供应商进行查询，业务可按需进行切换；2）优先级策略，即优先查询高优先级的供应商，若无法得到满足业务的服务（如第三方服务无响应或关键字段为空），则继续查询下一优先级的服务，保证业务不受第三方影响。这个设计思路也得到了业务的高度认可，在某次快速发卡（现场申请虚拟信用卡进行消费）的业务场景中，第三方接口突然服务中断，业务按指引进行了供应商优先级的切换，快速的解决了问题，保证了业务不受影响。</p>
<p>该项目架构稳定后，本人于17年年底交接了该系统的相关事项，截至当时，已接入数据源40余个，每日的查询量已接近千万级。在项目组各位的努力下，该系统也得到了各部门的一致好评。通过本次的项目架构实践，我学习了提高可靠性相关的分析方法和设计思路，也深刻体会到了系统架构设计和选择对项目影响的重要性。</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">keon</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://awdclijn.github.io/2018/11/09/论软件可靠性设计技术的应用/">https://awdclijn.github.io/2018/11/09/论软件可靠性设计技术的应用/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://awdclijn.github.io" target="_blank">keon随便写写</a>！</span></div></div><div class="post-meta__tag-list"></div><nav id="pagination"><div class="next-post pull-right"><a href="/2018/11/09/论软件系统架构评估/"><span>论软件系统架构评估</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2018 By keon</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/js/third-party/anime.min.js"></script><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.5.6"></script><script src="/js/fancybox.js?version=1.5.6"></script><script src="/js/sidebar.js?version=1.5.6"></script><script src="/js/copy.js?version=1.5.6"></script><script src="/js/fireworks.js?version=1.5.6"></script><script src="/js/transition.js?version=1.5.6"></script><script src="/js/scroll.js?version=1.5.6"></script><script src="/js/head.js?version=1.5.6"></script></body></html>