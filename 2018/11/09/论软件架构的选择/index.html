<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="论软件架构的选择"><meta name="keywords" content=""><meta name="author" content="keon,undefined"><meta name="copyright" content="keon"><title>论软件架构的选择 | keon随便写写</title><link rel="shortcut icon" href="/my-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.5.6"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css?version=1.5.6"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><link rel="dns-prefetch" href="https://hm.baidu.com"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?ae0586f75159e5097cb79871b2fdb3a1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();</script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
} </script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">keon</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">9</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">3</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">2</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://raw.githubusercontent.com/awdclijn/awdclijn.github.io/master/img/kim-holtermand-reflections.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">keon随便写写</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div><div id="post-info"><div id="post-title">论软件架构的选择</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-11-09</time><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">1,847</span><span class="post-meta__separator">|</span><span>阅读时长: 5 分钟</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>论文摘要</p>
<pre><code>2017年4月份，某股份制银行启动了新征信管理平台的系统项目，本人所在的大数据支持处室负责了数据存储、查询及数据标准化等功能的建设，本人作为项目经办负责技术方案的管理和设计。征信管理平台是我行风险控制的重要部分，维护有个人、对公征信、互联网小贷、电信运营商等数据。征信管理平台承载了大量业务在风险控制环节对数据的诉求，如新发卡、贷前、贷中等关键业务流程。本文介绍了几种主要架构风格及特点，论述了该项目在软件架构选择过程中，为何选择了三种风格的组合。最后，文章总结了采用该组合风格后带来的好处及缺点。
</code></pre><p>论文正文</p>
<p>背景介绍</p>
<pre><code>随着银行业的快速发展，各业务部对风险管理的要求越来越高，需要更加丰富的征信数据帮忙完成业务流程，同时旧征信平台中使用的传统应用和数据库架构已无法满足业务发展的需求，因此行内提出了建设新征信管理平台的诉求。大量的征信外部数据也是对大数据平台数据源的一个完善，因此我所在的处室承担了相关数据存储、查询及数据标准化等功能的建设（本文中仅对实时应用部分讨论，离线部分不具体展开），本人负责技术方案的管理和设计。
</code></pre><p>主要架构风格介绍</p>
<pre><code>在基本需求确认后，我们开始了系统架构的选择，首先是对常用的架构风格进行了分析。管道/过滤器风格，每个构件都有一组输入和输出，构件读输入的数据流，经过内部处理，然后产生输出数据流。这里的构件被称为过滤器，这种风格的连接件就像是数据流传输的管道，将一个过滤器的输出传到另一过滤器的输入。
基于事件的隐式调用风格，其思想是构件不直接调用一个过程，而是触发或广播一个或多个事件。系统中的其它构件中的过程在一个或多个事件中注册，当一个事件被触发，系统自动调用在这个事件中注册的所有过程，这样，一个事件的触发就导致了另一模块中的过程的调用。
微服务风格，是指开发一个单个小型的但有业务功能的服务，每个服务都有自己的处理和轻量通讯机制，可以部署在单个或多个服务器上。微服务也指一种种松耦合的、有一定的有界上下文的面向服务架构。
三层分层架构，将整个业务应用划分为界面层、业务逻辑层、数据访问层，目的是为了“高内聚低耦合”的思想。
</code></pre><p>架构风格选择</p>
<pre><code>结合业务需求和行内现有技术框架及系统环境的实际情况，最终我们再整体上选择了微服务架构，部分模块中使用分层架构，事件驱动，数据库系统这三种风格的混合模式。

在系统整体架构选择上，主要考虑了系统的可用性、性能及可扩展性，采用了微服务的风格：1、查询服务按业务领域进行划分，有征信服务、运营商服务、个人属性服务等负责具体数据的查询、主备供应商的切换及数据的标准化，并且将查询后的数据及相关的日志信息防止队列中间件中；2、数据回写服务负责从队列将数据入库，并根据规则生成有效期等字段，以便数据复用。3、服务治理的相关组件，注册中心负责管理服务的元信息；配置中心负责管理各服务的配置文件；网关负责交易请求的路由。4、业务数据存储上采用了分布式的中间件Elasticsearch，过程中直接存取非结构化数据，减少关联查询。按业务领域划分查询服务可以使得扩展更加灵活，不同业务领域的修改不会互相影响，当后续不同领域的数据供应商新增时，只需要新增服务，不需要修改远服务减少影响范围。同时个别繁忙服务需要扩充资源时，也能灵活扩充，不会造成浪费。

在面向业务使用的后台管理服务中，首先我们为了安装方便，采用了B/S架构，整体上将系统分为页面表现层，业务逻辑层及数据持久层这三层。表现层采用jsp文件实现，业务逻辑层为一组java service，数据持久层采用mybatis xml文件实现。这样设计的原因是可以降低层与层之间的依赖，便于各层逻辑的复用，在后期维护的时候，极大地降低了维护成本和维护时间

实际业务需求调研时我们了解到用户在多个地方有审批需求，比如业务机会阶段变更到2阶段时，项目名称修改时，及项目非正常关闭时，考虑到可能还会有其他地方需要审批，而审批是一个比较独立的功能模块，有自己的一系列行为，审批功能可能也会随着外部比如OA系统升级而做修改或替换。所以这里我们采用了事件驱动架构，将审批功能分装成一个独立构件，将启动审批流程过程注册到审批事件中，各个需要的功能界面只需触发审批事件即可。
</code></pre><p>总结</p>
<pre><code>项目耗时4个月时间最终成功上线，上线后得到使用单位用户和领导的高度认可，至今使用已经超过两年，后期维护过程中，用户单位由于业务分工及组织架构调整，项目池要求由原先的按照行业来划分修改为按照地区来划分，由于我们将项目池分类定义在数据库系统中，所以我们很快地就满足了用户的修改需求。另外，我们发现到采用该混合架构也存在一些缺陷，比如B/S分层架构带来的页面查询性能不佳，随着数据量的增加，首页刷新时间一度增加到8秒以上，针对这个问题，我们后来将首页分成几个块用多线程的方式分别独立刷新，现在速度提高至3秒左右。

通过这个项目，本人更进一步了解到系统架构设计的重要性，也意识到各类架构风格只为满足核心业务场景系统需求的本质。
</code></pre></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">keon</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://awdclijn.github.io/2018/11/09/论软件架构的选择/">https://awdclijn.github.io/2018/11/09/论软件架构的选择/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://awdclijn.github.io" target="_blank">keon随便写写</a>！</span></div></div><div class="post-meta__tag-list"></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2018/11/09/论软件系统架构评估/"><i class="fa fa-chevron-left">  </i><span>论软件系统架构评估</span></a></div><div class="next-post pull-right"><a href="/2018/09/12/《Kafka技术内幕》-读书笔记5/"><span>《Kafka技术内幕》--读书笔记5</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2018 By keon</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/js/third-party/anime.min.js"></script><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.5.6"></script><script src="/js/fancybox.js?version=1.5.6"></script><script src="/js/sidebar.js?version=1.5.6"></script><script src="/js/copy.js?version=1.5.6"></script><script src="/js/fireworks.js?version=1.5.6"></script><script src="/js/transition.js?version=1.5.6"></script><script src="/js/scroll.js?version=1.5.6"></script><script src="/js/head.js?version=1.5.6"></script></body></html>